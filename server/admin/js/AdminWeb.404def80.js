(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AdminWeb"],{"14c3":function(e,t,n){var r=n("da84"),a=n("c65b"),i=n("825a"),c=n("1626"),s=n("c6b6"),o=n("9263"),l=r.TypeError;e.exports=function(e,t){var n=e.exec;if(c(n)){var r=a(n,e,t);return null!==r&&i(r),r}if("RegExp"===s(e))return a(o,e,t);throw l("RegExp#exec called on incompatible receiver")}},"466d":function(e,t,n){"use strict";var r=n("c65b"),a=n("d784"),i=n("825a"),c=n("50c4"),s=n("577e"),o=n("1d80"),l=n("dc4a"),u=n("8aa5"),d=n("14c3");a("match",(function(e,t,n){return[function(t){var n=o(this),a=void 0==t?void 0:l(t,e);return a?r(a,t,n):new RegExp(t)[e](s(n))},function(e){var r=i(this),a=s(e),o=n(t,r,a);if(o.done)return o.value;if(!r.global)return d(r,a);var l=r.unicode;r.lastIndex=0;var m,p=[],f=0;while(null!==(m=d(r,a))){var h=s(m[0]);p[f]=h,""===h&&(r.lastIndex=u(a,c(r.lastIndex),l)),f++}return 0===f?null:p}]}))},"4de4":function(e,t,n){"use strict";var r=n("23e7"),a=n("b727").filter,i=n("1dde"),c=i("filter");r({target:"Array",proto:!0,forced:!c},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},8568:function(e,t,n){"use strict";var r=n("c7eb"),a=n("1da1"),i=(n("ac1f"),n("466d"),n("99af"),n("b0c0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{staticClass:"d-flex jc-between"},[n("el-form-item",{staticClass:"el-form-search-item d-flex"},[n("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},on:{change:function(t){return e.$emit("keywordChange",t)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.searchFetch("search")}},slot:"append"})],1),n("el-button",{attrs:{title:"刷新",icon:"el-icon-refresh-left"},on:{click:function(t){return e.searchFetch("refresh")}}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.$router.push("/"+e.modelName+"/create")}}},[e._v("添加")]),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:{action:"DELETE",effect:"disabled"},expression:"{action: 'DELETE', effect: 'disabled'}"}],attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.removeMany}},[e._v("批量删除")])],1)],1)}),c=[],s=(n("a9e3"),{name:"ListForm",props:{modelName:{required:!0,type:String},currentPage:{required:!0,type:Number},size:{required:!0,type:Number},selectionList:{required:!0,type:Array},removeMany:{required:!0,type:Function}},data:function(){return{keyword:""}},methods:{searchFetch:function(e){var t=this;return Object(a["a"])(Object(r["a"])().mark((function n(){var a,i;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("search"!==e){n.next=11;break}if(!t.keyword){n.next=8;break}return n.next=4,t.$http.get("rest/".concat(t.modelName,"?page=").concat(t.currentPage,"&size=").concat(t.size).concat(t.keyword?"&search="+t.keyword:""));case 4:a=n.sent,t.$emit("searchData",a.data.items),n.next=9;break;case 8:t.$message({message:"请输入搜索关键字",type:"warning"});case 9:n.next=16;break;case 11:if("refresh"!==e){n.next=16;break}return n.next=14,t.$http.get("rest/".concat(t.modelName,"?page=").concat(t.currentPage,"&size=").concat(t.size).concat(t.keyword?"&search="+t.keyword:""));case 14:i=n.sent,t.$emit("searchData",i.data.items);case 16:case"end":return n.stop()}}),n)})))()}}}),o=s,l=n("2877"),u=Object(l["a"])(o,i,c,!1,null,null,null),d=u.exports,m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.editBtnPermission,expression:"editBtnPermission"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$router.push("/"+e.modelName+"/edit/"+e.row._id)}}},[e._v("编辑")]),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.deleteBtnPermission,expression:"deleteBtnPermission"}],attrs:{type:"danger",size:"small"},on:{click:function(t){return e.removeOne(e.row)}}},[e._v("删除")])],1)},p=[],f={name:"ListOptionBtn",props:{modelName:{type:String,required:!0},row:{type:Object,required:!0},removeOne:{type:Function,required:!0},editBtnHide:{type:Boolean,required:!1},deleteBtnHide:{type:Boolean,required:!1}},computed:{editBtnPermission:function(){return this.editBtnHide?{action:"PUT"}:{action:"PUT",effect:"disabled"}},deleteBtnPermission:function(){return this.deleteBtnHide?{action:"DELETE"}:{action:"DELETE",effect:"disabled"}}}},h=f,b=Object(l["a"])(h,m,p,!1,null,null,null),g=b.exports;t["a"]={components:{ListForm:d,ListOptionBtn:g},data:function(){return{items:[],selectionList:[],pageSize:10,currentPage:1,totalSize:0,searchKeyword:"",modelName:this.$route.path.match(/\/(\w+?)\//i)[1]}},methods:{fetch:function(){var e=this;return Object(a["a"])(Object(r["a"])().mark((function t(){var n;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("rest/".concat(e.modelName,"?page=").concat(e.currentPage,"&size=").concat(e.pageSize).concat(e.searchKeyword?"&search="+e.searchKeyword:""));case 2:n=t.sent,e.items=n.data.items,e.totalSize=n.data.totalCount;case 5:case"end":return t.stop()}}),t)})))()},remove:function(e){var t=this;return Object(a["a"])(Object(r["a"])().mark((function n(){return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$confirm('是否确定要删除"'.concat(e.name?e.name:e.path,'"?'),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(a["a"])(Object(r["a"])().mark((function n(){return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.delete("rest/".concat(t.modelName,"/").concat(e._id));case 2:t.$message({type:"success",message:"删除成功!"}),t.fetch();case 4:case"end":return n.stop()}}),n)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 1:case"end":return n.stop()}}),n)})))()},removeMany:function(){var e=this;return Object(a["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.selectionList.length?e.$confirm("是否确定要删除已选中的".concat(e.selectionList.length,"条数据?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(a["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.delete("rest/".concat(e.modelName,"/"),{data:e.selectionList});case 2:e.$message({type:"success",message:"删除成功!"}),e.fetch();case 4:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消删除"})})):e.$message({message:"请选择要删除的数据",type:"warning"});case 1:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){this.currentPage=e,console.log(this.currentPage),this.fetch()},handleSearchedData:function(e){this.items=e},handleSelectionChange:function(e){this.selectionList=e}},created:function(){this.fetch()}}},"8aa5":function(e,t,n){"use strict";var r=n("6547").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},"99af":function(e,t,n){"use strict";var r=n("23e7"),a=n("da84"),i=n("d039"),c=n("e8b5"),s=n("861d"),o=n("7b0b"),l=n("07fa"),u=n("8418"),d=n("65f0"),m=n("1dde"),p=n("b622"),f=n("2d00"),h=p("isConcatSpreadable"),b=9007199254740991,g="Maximum allowed index exceeded",v=a.TypeError,w=f>=51||!i((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),y=m("concat"),x=function(e){if(!s(e))return!1;var t=e[h];return void 0!==t?!!t:c(e)},k=!w||!y;r({target:"Array",proto:!0,arity:1,forced:k},{concat:function(e){var t,n,r,a,i,c=o(this),s=d(c,0),m=0;for(t=-1,r=arguments.length;t<r;t++)if(i=-1===t?c:arguments[t],x(i)){if(a=l(i),m+a>b)throw v(g);for(n=0;n<a;n++,m++)n in i&&u(s,m,i[n])}else{if(m>=b)throw v(g);u(s,m++,i)}return s.length=m,s}})},"9b93":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("后台页面列表")]),n("list-form",{attrs:{modelName:"admin_webs",currentPage:e.currentPage,size:e.pageSize,selectionList:e.selectionList,removeMany:e.removeMany},on:{keywordChange:function(t){e.searchKeyword=t},searchData:e.handleSearchedData}}),n("el-table",{attrs:{data:e.items},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{prop:"_id",label:"ID"}}),n("el-table-column",{attrs:{prop:"name",label:"名称"}}),n("el-table-column",{attrs:{prop:"path",label:"路由地址"}}),n("el-table-column",{attrs:{prop:"menu.name",label:"对应的菜单"}}),n("el-table-column",{attrs:{prop:"rights",label:"操作权限"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row.rights;return e._l(r,(function(t,r){return n("el-tag",{key:"rtag"+r,attrs:{type:e.methodType[t]}},[e._v(e._s(t))])}))}}])}),n("el-table-column",{attrs:{prop:"description",label:"描述"}}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("ListOptionBtn",{attrs:{modelName:e.modelName,row:t.row,removeOne:e.remove}})]}}])})],1),n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":10,background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.totalSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},a=[],i=n("8568"),c={name:"AdminWebList",mixins:[i["a"]],data:function(){return{methodType:{POST:"success",PUT:"warning",DELETE:"danger"}}}},s=c,o=n("2877"),l=Object(o["a"])(s,r,a,!1,null,null,null);t["default"]=l.exports},d784:function(e,t,n){"use strict";n("ac1f");var r=n("e330"),a=n("cb2d"),i=n("9263"),c=n("d039"),s=n("b622"),o=n("9112"),l=s("species"),u=RegExp.prototype;e.exports=function(e,t,n,d){var m=s(e),p=!c((function(){var t={};return t[m]=function(){return 7},7!=""[e](t)})),f=p&&!c((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[l]=function(){return n},n.flags="",n[m]=/./[m]),n.exec=function(){return t=!0,null},n[m](""),!t}));if(!p||!f||n){var h=r(/./[m]),b=t(m,""[e],(function(e,t,n,a,c){var s=r(e),o=t.exec;return o===i||o===u.exec?p&&!c?{done:!0,value:h(t,n,a)}:{done:!0,value:s(n,t,a)}:{done:!1}}));a(String.prototype,e,b[0]),a(u,m,b[1])}d&&o(u[m],"sham",!0)}},ffcc:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"about"},[n("h1",[e._v(e._s(e.id?"编辑":"新建")+"后台页面")]),n("el-form",{ref:"AdminWebForm",attrs:{model:e.model,rules:e.rules,"label-width":"120px"},nativeOn:{submit:function(t){return t.preventDefault(),e.save.apply(null,arguments)}}},[n("el-form-item",{attrs:{prop:"name",label:"名称"}},[n("el-input",{attrs:{placeholder:"以 页面 两个字结尾"},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),n("el-form-item",{attrs:{prop:"path",label:"页面地址"}},[n("el-input",{attrs:{placeholder:"输入页面的路由地址"},model:{value:e.model.path,callback:function(t){e.$set(e.model,"path",t)},expression:"model.path"}})],1),n("el-form-item",{attrs:{prop:"menu",label:"所属菜单"}},[n("el-select",{attrs:{filterable:"",clearable:"",placeholder:"一个菜单对应一个页面"},on:{change:e.bindMenuChange},model:{value:e.model.menu,callback:function(t){e.$set(e.model,"menu",t)},expression:"model.menu"}},e._l(e.menuList,(function(e){return n("el-option",{key:e._id,attrs:{label:e.name,value:e._id,disabled:e.disabled}})})),1)],1),n("el-form-item",{attrs:{prop:"rights",label:"页面权限"}},[n("el-select",{attrs:{multiple:"",placeholder:"选择权限"},model:{value:e.model.rights,callback:function(t){e.$set(e.model,"rights",t)},expression:"model.rights"}},e._l(e.apiMethods,(function(e,t,r){return n("el-option",{key:"mds"+r,attrs:{label:t,value:e}})})),1)],1),n("el-form-item",{attrs:{prop:"description",label:"描述"}},[n("el-input",{attrs:{type:"textarea",placeholder:"描述"},model:{value:e.model.description,callback:function(t){e.$set(e.model,"description",t)},expression:"model.description"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("保存")])],1)],1)],1)},a=[],i=n("c7eb"),c=n("1da1"),s=(n("4de4"),n("d3b7"),{name:"AdminWebEdit",props:{id:{}},computed:{menuList:function(){return this.menus.filter((function(e){if(e.parent&&e.parent.parent)return e.page&&(e.disabled=!0),e}))}},data:function(){return{model:{name:"",path:"",menu:"",rights:[],description:""},menus:[],apiMethods:{"查看 GET":"GET","新增 POST":"POST","修改 PUT":"PUT","删除 DELETE":"DELETE","搜索 SEARCH":"SEARCH"},rules:{name:[{required:!0,message:"请输入页面名称",trigger:"blur"}],path:[{required:!0,message:"请输入页面的路由地址",trigger:"blur"}],menu:[{required:!0,message:"请选择一个菜单",trigger:"change"}],rights:[{required:!0,message:"请选择页面拥有的操作",trigger:"change"}],description:[{required:!0,message:"请输入页面描述",trigger:"blur"}]}}},methods:{save:function(){var e=this;return Object(c["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs["AdminWebForm"].validate(function(){var t=Object(c["a"])(Object(i["a"])().mark((function t(n){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=15;break}if(!e.id){t.next=6;break}return t.next=4,e.$http.put("rest/admin_webs/".concat(e.id),e.model);case 4:t.next=11;break;case 6:if(0!==e.model.menu.length){t.next=9;break}return e.$message({message:"请选择一个菜单项",type:"warning"}),t.abrupt("return",!1);case 9:return t.next=11,e.$http.post("rest/admin_webs",e.model);case 11:e.$router.push("/admin_webs/list"),e.$message({type:"success",message:"保存成功"}),t.next=17;break;case 15:return e.$message({type:"error",message:"表单信息不完整"}),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},bindMenuChange:function(e){1!==e.length&&this.$message({message:"只能选择一个菜单",type:"warining"})},fetch:function(){var e=this;return Object(c["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("rest/admin_webs/".concat(e.id));case 2:n=t.sent,e.model=n.data;case 4:case"end":return t.stop()}}),t)})))()},fetchMenu:function(){var e=this;return Object(c["a"])(Object(i["a"])().mark((function t(){var n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("rest/menus");case 2:n=t.sent,e.menus=n.data.items;case 4:case"end":return t.stop()}}),t)})))()}},created:function(){this.id&&this.fetch(),this.fetchMenu()}}),o=s,l=n("2877"),u=Object(l["a"])(o,r,a,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=AdminWeb.404def80.js.map